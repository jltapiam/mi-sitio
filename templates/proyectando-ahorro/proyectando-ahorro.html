{% extends 'base.html' %}
{% load crispy_forms_tags %}
{% crispy form form.helper %}

{% block title %}
  Proyectando ahorro
{% endblock title %}

{% block body %}
{% load crispy_forms_tags %}

  <div class="container-sm-fluid container-lg">
    <div class='row'>
      <div class='col-sm-12 col-md-4 ps-2 pt-lg-5 mt-lg-5'>
          {% crispy form %}
      </div>

      <div class='col-sm-12 col-md-8 pe-2'>
        
        {% comment %} título {% endcomment %}
        {% if request.method == 'POST' %}
          <h2 class="text-center">Proyección para {{ producto }}</h2>
          
          <ul class="nav nav-tabs justify-content-center rounded">
            <li class="nav-item border">
              <a class="nav-link text-white active" data-bs-toggle="pill" href="#pie">Gráfica</a>
            </li>
            <li class="nav-item border">
              <a class="nav-link text-white" data-bs-toggle="pill" href="#df">Tabla</a>
            </li>
          </ul>
          
          <div class="tab-content">
            <div id="pie" class="container tab-pane fade show active">
              {% comment %} pie {% endcomment %}
              <div>
                {% comment %} st.write(f'# *Resumen proyecto {nombre_producto}*')
                mygrid = make_grid(2, 2)

                mygrid[1][0].write(f" El objetivo es: ${formatNumber(int(monto_objetivo), 0)}")
                mygrid[1][0].write(f" El resultado es: ${formatNumber(int(df_padp['Valor cuota'].sum() + df_padp['Ganancia'].sum()), 0)}")
                mygrid[1][0].write("\tAcumulado con cuota personal: ${}".format(formatNumber(int(df_padp['Valor cuota'].sum()), 0)))
                mygrid[1][0].write("\tTasa de interés ahorro personal {}%".format(round(tasa_int_personal * 100, 2)))
                mygrid[1][0].write("\tGanancia inversión: ${}".format(formatNumber(int(df_padp['Ganancia'].sum()), 0)))
                mygrid[1][0].write(f" El saldo: ${formatNumber(int((df_padp['Valor cuota'].sum() + df_padp['Ganancia'].sum()) - monto_objetivo), 0)}") {% endcomment %}
              </div>
              <div>
                {% if pie %}
                <img src="data:image/png;base64,{{ pie }}" alt="pie chart">
                {% endif %}
              </div>
            </div>
            <div id="df" class="container tab-pane fade show">
              {% comment %} df {% endcomment %}
              <div class="table-wrapper">
                {% if df %}
                {% autoescape off %}
                {{ df }}
                {% endautoescape %}
                {% endif %}
              </div>
            </div>
          </div>
          
        {% endif %}
          
      </div>
    </div>
  </div>
    
{% endblock body %}
